@if (isOpen()) {
  <div 
    class="aide-media-modal-overlay"
    (click)="onOverlayClick($event)"
    (keydown)="onKeyDown($event)"
    tabindex="0"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title">
    <div class="aide-media-modal-content">
      <button 
        class="close-button"
        (click)="closeModal()"
        aria-label="Fermer le modal"
        type="button">
        ✕
      </button>

      @if (hasImage() && safeImageUrl()) {
        <div class="media-container image-container">
          <img 
            [src]="safeImageUrl()!" 
            [alt]="'Image d\'aide'"
            class="aide-image">
        </div>
      }

      @if (hasVideo()) {
        <div class="media-container video-container">
          @if (videoEmbedUrl()) {
            <iframe
              [src]="videoEmbedUrl()!"
              class="aide-video"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              title="Vidéo d'aide">
            </iframe>
          } @else {
            <div class="video-error">
              <p>Impossible de charger la vidéo. URL non supportée.</p>
              <a [href]="aideVideoUrl()!" target="_blank" rel="noopener noreferrer">
                Ouvrir dans un nouvel onglet
              </a>
            </div>
          }
        </div>
      }
    </div>
  </div>
}
