<div class="memory-game">
  @if (instructions) {
    <div class="game-instructions">
      <p>{{ instructions }}</p>
    </div>
  }
  @if (question) {
    <div class="game-question">
      <h2>{{ question }}</h2>
    </div>
  }
  <app-aide-section
    [aides]="aides"
    [aideImageUrl]="aideImageUrl"
    [aideVideoUrl]="aideVideoUrl">
  </app-aide-section>

  <div class="progress-info">
    Paires trouvées : {{ getProgress() }} / {{ getTotalPairs() }}
  </div>

  <div class="memory-grid" [class.disabled]="disabled || isSubmitted()" [style.grid-template-columns]="'repeat(' + gridColumns() + ', 1fr)'">
    @for (card of cards(); track card.id) {
      <div 
        [class]="getCardClass(card)"
        (click)="flipCard(card.id)"
        [attr.aria-label]="card.isFlipped ? (card.type === 'question' ? 'Question: ' + card.content : 'Réponse: ' + card.content) : 'Carte retournée'"
        [attr.aria-pressed]="card.isFlipped"
        role="button"
        tabindex="0"
        (keydown.enter)="flipCard(card.id)"
        (keydown.space)="flipCard(card.id); $event.preventDefault()">
        <div class="card-inner">
          <div class="card-front">
            <span class="card-mark">?</span>
          </div>
          <div class="card-back" [class.question-card]="card.type === 'question'" [class.reponse-card]="card.type === 'reponse'">
            <div class="card-content">
              {{ card.content }}
            </div>
          </div>
        </div>
      </div>
    }
  </div>

  <app-game-error-actions
    [isSubmitted]="isSubmitted()"
    [isCorrect]="isCorrect()"
    (resetRequested)="reset()"
    (nextRequested)="nextRequested.emit()">
  </app-game-error-actions>

</div>

