<div class="memory-game">
  @if (instructions) {
    <div class="game-instructions">
      <p>{{ instructions }}</p>
    </div>
  }
  @if (question) {
    <div class="game-question">
      <h2>{{ question }}</h2>
    </div>
  }
  @if (aides && aides.length > 0) {
    <div class="aides-toggle-container">
      <button 
        type="button"
        class="aides-toggle-btn"
        (click)="toggleAides()"
        [attr.aria-expanded]="showAides()"
        [attr.aria-label]="showAides() ? 'Masquer aide' : 'Afficher aide'">
        <span class="toggle-icon">{{ showAides() ? '−' : '+' }}</span>
        <span class="toggle-text">{{ showAides() ? 'Masquer aide' : 'Afficher aide' }}</span>
      </button>
      @if (showAides()) {
        <div class="aides-container">
          <strong>Aide :</strong>
          <ul>
            @for (aide of aides; track $index) {
              <li>{{ aide }}</li>
            }
          </ul>
        </div>
      }
    </div>
  }
  @if (isSubmitted() && isCorrect()) {
    <div class="result-message correct">
      ✅ Bravo ! Toutes les paires ont été trouvées !
    </div>
  }

  <div class="progress-info">
    Paires trouvées : {{ getProgress() }} / {{ getTotalPairs() }}
  </div>

  <div class="memory-grid" [class.disabled]="disabled || isSubmitted()">
    @for (card of cards(); track card.id) {
      <div 
        [class]="getCardClass(card)"
        (click)="flipCard(card.id)"
        [attr.aria-label]="card.isFlipped ? (card.type === 'question' ? 'Question: ' + card.content : 'Réponse: ' + card.content) : 'Carte retournée'"
        [attr.aria-pressed]="card.isFlipped"
        role="button"
        tabindex="0"
        (keydown.enter)="flipCard(card.id)"
        (keydown.space)="flipCard(card.id); $event.preventDefault()">
        <div class="card-inner">
          <div class="card-front">
            <span class="card-mark">?</span>
          </div>
          <div class="card-back" [class.question-card]="card.type === 'question'" [class.reponse-card]="card.type === 'reponse'">
            <div class="card-content">
              {{ card.content }}
            </div>
          </div>
        </div>
      </div>
    }
  </div>

  <app-game-error-actions
    [isSubmitted]="isSubmitted()"
    [isCorrect]="isCorrect()"
    (resetRequested)="reset()"
    (nextRequested)="nextRequested.emit()">
  </app-game-error-actions>
</div>

