<div class="ai-generated-preview" *ngIf="generatedGames.length > 0">
  <div class="preview-header">
    <h3>ğŸ® Jeux gÃ©nÃ©rÃ©s par l'IA ({{ generatedGames.length }})</h3>
    <p class="subtitle">VÃ©rifiez, modifiez ou supprimez les jeux avant de les sauvegarder</p>
  </div>

  <div class="games-list">
    <div *ngFor="let game of generatedGames; let i = index" class="game-card" [class.editing]="game._isEditing">
      <div class="game-header">
        <div class="game-number">Jeu #{{ i + 1 }}</div>
        <span class="game-type-badge">{{ getGameTypeName(game) }}</span>
      </div>

      <!-- Mode lecture -->
      <div *ngIf="!game._isEditing" class="game-preview">
        <div class="game-content">
          <h4 *ngIf="game.question" class="game-question">{{ game.question }}</h4>
          <p *ngIf="game.instructions" class="game-instructions">{{ game.instructions }}</p>
          
          <div class="game-metadata">
            <strong>Contenu:</strong> {{ formatMetadataForDisplay(game) }}
          </div>

          <div *ngIf="game.aides && game.aides.length > 0" class="game-aides">
            <strong>Aides ({{ game.aides.length }}):</strong>
            <ul>
              <li *ngFor="let aide of game.aides">{{ aide }}</li>
            </ul>
          </div>
        </div>

        <div class="game-actions">
          <button class="btn btn-secondary" (click)="toggleEdit(game)">
            âœï¸ Modifier
          </button>
          <button class="btn btn-danger" (click)="onRemove(game)">
            ğŸ—‘ï¸ Supprimer
          </button>
        </div>
      </div>

      <!-- Mode Ã©dition avec composants rÃ©utilisÃ©s -->
      <div *ngIf="game._isEditing" class="game-edit">
        <div class="edit-notice">
          âš ï¸ Mode Ã©dition - Utilisez le formulaire ci-dessous pour modifier le jeu
        </div>

        <!-- Champs globaux (instructions, question, aides) -->
        <app-game-global-fields
          [initialData]="getGlobalFieldsData(game)"
          (dataChange)="onGlobalFieldsChange(game, $event)"
          (validityChange)="onGlobalFieldsValidityChange()">
        </app-game-global-fields>

        <hr class="form-divider">

        <!-- Formulaires spÃ©cifiques pour chaque type -->
        <!-- QCM -->
        <app-qcm-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'qcm'"
          [initialData]="getInitialDataForQcm(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-qcm-form>

        <!-- Case vide -->
        <app-case-vide-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'case vide'"
          [initialData]="getInitialDataForCaseVide(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-case-vide-form>

        <!-- RÃ©ponse libre -->
        <app-reponse-libre-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'reponse libre'"
          [initialData]="getInitialDataForReponseLibre(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-reponse-libre-form>

        <!-- Liens -->
        <app-liens-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'liens'"
          [initialData]="getInitialDataForLiens(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-liens-form>

        <!-- Chronologie -->
        <app-chronologie-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'chronologie'"
          [initialData]="getInitialDataForChronologie(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-chronologie-form>

        <!-- Vrai/Faux -->
        <app-vrai-faux-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'vrai/faux'"
          [initialData]="getInitialDataForVraiFaux(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-vrai-faux-form>

        <!-- Memory -->
        <app-memory-form 
          *ngIf="getGameTypeName(game).toLowerCase() === 'memory'"
          [initialData]="getInitialDataForMemory(game)"
          (dataChange)="onGameDataChange(game, $event)"
          (validityChange)="onGameValidityChange($event)">
        </app-memory-form>

        <div class="edit-actions">
          <button class="btn btn-primary" (click)="toggleEdit(game)">
            âœ… Terminer l'Ã©dition
          </button>
          <button class="btn btn-secondary" (click)="toggleEdit(game)">
            âŒ Annuler
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="preview-actions">
    <button class="btn btn-success btn-large" (click)="saveAll.emit()">
      ğŸ’¾ Sauvegarder tous les jeux ({{ generatedGames.length }})
    </button>
    <button class="btn btn-secondary" (click)="cancelAll.emit()">
      âŒ Annuler tout
    </button>
  </div>
</div>

<div *ngIf="generatedGames.length === 0" class="empty-state">
  <p>Aucun jeu gÃ©nÃ©rÃ© pour le moment</p>
</div>

